Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 ovideo (1-186) bionic; urgency=medium
 .
   * fsin fcos fix
Author: bc <bc@bc-HP-Pavilion-x360-Convertible>

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: https://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: 2023-01-08

--- /dev/null
+++ ovideo-1/.github/FUNDING.yml
@@ -0,0 +1,13 @@
+# These are supported funding model platforms
+
+github: # Replace with up to 4 GitHub Sponsors-enabled usernames e.g., [user1, user2]
+patreon: # Replace with a single Patreon username
+open_collective: # Replace with a single Open Collective username
+ko_fi: # Replace with a single Ko-fi username
+tidelift: # Replace with a single Tidelift platform-name/package-name e.g., npm/babel
+community_bridge: # Replace with a single Community Bridge project-name e.g., cloud-foundry
+liberapay: costin
+issuehunt: # Replace with a single IssueHunt username
+otechie: # Replace with a single Otechie username
+lfx_crowdfunding: # Replace with a single LFX Crowdfunding project-name e.g., cloud-foundry
+custom: # Replace with up to 4 custom sponsorship URLs e.g., ['link1', 'link2']
--- ovideo-1.orig/.github/workflows/appimage.yml
+++ ovideo-1/.github/workflows/appimage.yml
@@ -50,7 +50,8 @@ jobs:
       arch_ai=-x86_64
       archfile=${file}${arch_ai}
       kitpart () {
-       urlpart=`wget -q https://github.com/AppImage/AppImageKit/releases/latest -O - | grep "${archfile}" | head -n 1 | cut -d '"' -f 2`
+       #this is not working anymore urlpart=`wget -q https://github.com/AppImage/AppImageKit/releases/latest -O - | grep "${archfile}" | head -n 1 | cut -d '"' -f 2`
+       urlpart=AppImage/AppImageKit/releases/latest/download/${archfile}
       }
       if [ ! -e "${file}" ]; then
        kitpart
--- /dev/null
+++ ovideo-1/.github/workflows/delrel.yml
@@ -0,0 +1,15 @@
+
+on:
+ workflow_dispatch:
+  inputs:
+   tag:
+    description: "project version"
+
+jobs:
+ delrel:
+   runs-on: ubuntu-latest
+   steps:
+    - uses: cb80/delrel@latest
+      with:
+       tag: ${{ github.event.inputs.tag }}
+       token: ${{ secrets.PAT }}
--- ovideo-1.orig/.github/workflows/rpm.yml
+++ ovideo-1/.github/workflows/rpm.yml
@@ -41,7 +41,7 @@ jobs:
       sudo apt install alien
       sudo alien -rk ../${name}.deb
       fname=`ls`
-      mv ${fname} ../
+      mv ${fname} ../${fname}
       echo "file=${fname}" >> $GITHUB_ENV
    - name: artifact
      uses: actions/upload-artifact@v3
--- ovideo-1.orig/arh/a
+++ ovideo-1/arh/a
@@ -27,11 +27,3 @@ sudo apt install --dry-run ${p}
 #at 128 , text 85 max
 
 #rpmrebuild -enp ./*.rpm
-
-#this is a blocker
-#BuildArch:     i386
-
-#Requires:      libgstgdkpixbuf.so
-#Requires:      libgstmxf.so
-
-#touch /tmp/usr/share/ovideo/regforkoff
--- /dev/null
+++ ovideo-1/arh/re
@@ -0,0 +1,20 @@
+
+touch ./usr/share/ovideo/regforkoff
+
+#sudo sed is still permission
+
+#this is a blocker
+#BuildArch:     i386
+sed '/^BuildArch:.*i386$/d' text > text2
+
+#Requires:      libgstgdkpixbuf.so
+#Requires:      libgstmxf.so
+sed '/^#Requires.*CompressedFileNames.*$/i Requires:      libgstgdkpixbuf.so\nRequires:      libgstmxf.so\n' text2 > text3
+rm text2
+
+#%attr(0644, root, root) "/usr/share/ovideo/regforkoff"
+sed -e "$(grep -n '^%attr.*\"$' text3 | tail -1 | cut -f1 -d ':')a %attr(0644, root, root) \"/usr/share/ovideo/regforkoff\"" text3 > text2
+cat text2
+rm text3
+
+sudo mv text2 text
--- ovideo-1.orig/readme.md
+++ ovideo-1/readme.md
@@ -11,12 +11,14 @@ Install:
 sudo apt-get install ovideo
 ```
 \
-On linux distributions, appimage from ubuntu bionic.\
-<i>.AppImage</i> file from [releases](https://github.com/colin-i/ostream/releases).\
+On linux distributions, <i>.AppImage</i> file from [releases](https://github.com/colin-i/ostream/releases).\
 \
-On Fedora, not ready.\
+On Fedora, <i>.rpm</i> file from [releases](https://github.com/colin-i/ostream/releases).\
 Missing libjpeg.so.8? https://download.copr.fedorainfracloud.org/results/aflyhorse/libjpeg/fedora-36-i386/ \
-Unacceptable TLS certificate? Put [glib-networking:i386 bionic release libgiognutls.so](https://github.com/colin-i/test/releases/download/1.1/libgiognutls.so) in a folder and point to that folder with GIO_EXTRA_MODULES variable. \
+Unacceptable TLS certificate? Put [glib-networking:i386 bionic release libgiognutls.so](https://github.com/colin-i/test/releases/download/1.1/libgiognutls.so) in a folder and point to that folder with GIO_EXTRA_MODULES variable.
+```sh
+yum install ovideo-*.*.rpm
+```
 \
 On Windows, <i>.windows.zip</i> file from [releases](https://github.com/colin-i/ostream/releases).\
 <i>Gstreamer sdk</i> is [here](https://www.freedesktop.org/software/gstreamer-sdk/data/packages/windows/x86/).
--- ovideo-1.orig/soundrecorder/src/Makefile
+++ ovideo-1/soundrecorder/src/Makefile
@@ -9,20 +9,17 @@ srcname=${projname}.s
 logname=${srcname}.log
 wprojname=${projname}.exe
 
-all: compile link
+all: ${wprojname}
 
-compile: ${projname} ounused
+%.o: %.s
+	${OCOMP} $< ${OFLAGS}
 
-ounused:
+${wprojname}: ${objname}
 	ounused ${logname}
-
-link:
+	@echo
 	i686-w64-mingw32-ld ${syms} ${objname} -o ${wprojname} -entry record \
 		 -lmsvcrt -lkernel32 -lwinmm -luser32
 
-%: %.s
-	${OCOMP} $< ${OFLAGS}
-
 clean:
 	-rm -f ${logname}
 	-rm -f ${objname}
--- ovideo-1.orig/soundrecorder/src/soundrecorder.s
+++ ovideo-1/soundrecorder/src/soundrecorder.s
@@ -204,6 +204,8 @@ function record_fileandsizes(sd thread_i
 endfunction
 
 function record_got_file(sd file,sd thread_id)
+#const _RIFF^riff
+const _RIFF=!
     chars riff={R,I,F,F}
     data riffsize#1
 
@@ -224,9 +226,10 @@ function record_got_file(sd file,sd thre
     chars datatag={d,a,t,a}
     data datasize#1
 
+#const RIFF_^RIFF
+const RIFF_=!
+
     data RIFF^riff
-    const _RIFF^riff
-    const RIFF_^RIFF
     const RIFF_size=RIFF_-_RIFF
 
     const _WAVEFORMATEX^wFormatTag
--- ovideo-1.orig/src/Makefile
+++ ovideo-1/src/Makefile
@@ -2,13 +2,7 @@
 platform = lin
 OCOMP=o
 syms=-s
-
-ifeq (${platform},win)
-	OFLAGS = inplace_reloc 0 include_sec 1
-else
-	OFLAGS = underscore_pref 1
-	dynlink=/lib/ld-linux.so.2
-endif
+projname=ovideo
 
 cap = _capture/capture
 err = err/err
@@ -44,28 +38,50 @@ uti = ${u}asm ${u}floating ${u}lists ${u
 items = _dif/dif~${platform} ${cap} ${err} ${eve} ${exe} ${ffl} ${gnu} ${int} ${med} ${mem} ${net} ${obj} ${pre} ${sea} ${str} ${uti}
 items_prefix=
 
-projname=ovideo
-wprojname=ovideo.exe
+$(eval obs = )
+$(foreach var,$(items),$(eval obs += ${items_prefix}${var}.o))
+$(eval logs = )
+$(foreach var,$(items),$(eval logs += ${items_prefix}${var}.s.log))
+
+ifeq (${platform},lin)
+
+OFLAGS = underscore_pref 1 ${OFLAGSEXTRA}
+lprojname=${items_prefix}${projname}
 lshare=_dif/share.txt
-logs :=
-obs :=
 sharefolderpackage=$(prefix)/share/ovideo
 sharefolder=$(DESTDIR)${sharefolderpackage}
+dynlink=/lib/ld-linux.so.2
+all: ${lprojname}
+${lprojname}: ${lshare} ${obs}
+	ounused ${logs}
+	@echo
+	export PKG_CONFIG_PATH=/usr/lib/i386-linux-gnu/pkgconfig/:${PKG_CONFIG_PATH}; \
+	$(LD) ${syms} -melf_i386 --dynamic-linker=${dynlink} ${obs} -o ${lprojname} -lc -lm `pkg-config --libs gtk+-2.0 gstreamer-pbutils-1.0 gstreamer-app-1.0` -ljpeg -lsoup-2.4 -lasound -lgthread-2.0 -lpthread;
+${lshare}:
+	echo chars prestart=0x2e\;chars simplestart=\"${sharefolderpackage}\"\;return \#simplestart > ${lshare}; \
 
-all: compile lnk
-
-compile: share ${items} ounused
+else
 
-ounused:
+OFLAGS = inplace_reloc 0 include_sec 1 ${OFLAGSEXTRA}
+wprojname=${projname}.exe
+all: ${wprojname}
+${wprojname}: ${obs}
 	ounused ${logs}
+	@echo
+	i686-w64-mingw32-ld --large-address-aware ${syms} ${obs} -o ${wprojname} -entry _start --start-group \
+	`dpkg -L mingw-w64-i686-dev | grep '\.a' | sed 's/..$$//' | grep -o '[^\/]*$$' | sed 's/^lib/-l/' | xargs echo` \
+	--end-group -L`echo ~`/.wine/drive_c/gstreamer-sdk/0.10/x86/lib/ \
+	-lgtk-win32-2.0 -lgdk-win32-2.0 -lgdk_pixbuf-2.0 -lglib-2.0 -lgobject-2.0 -lgio-2.0 -lgthread-2.0 \
+	-lgstreamer-0.10 -lgstapp-0.10 -lgstinterfaces-0.10 -lgstpbutils-0.10 \
+	-lcairo -lpango-1.0 -lsoup-2.4 -ljpeg;
 
-share:
-	if [ "${platform}" = "lin" ]; then \
-		echo chars prestart=0x2e\;chars simplestart=\"${sharefolderpackage}\"\;return \#simplestart > ${lshare}; \
-	fi
+endif
+
+
+#at jammy libgtk2.0-dev:i386,libgstreamer-plugins-base1.0-dev:i386,libsoup2.4-dev:i386,libasound2-dev:i386
 
 #at bionic
-#libgtk2.0-dev:i386	libgtk2.0-0:i386
+#libgtk2.0-dev:i386	libgtk2.0-0:i386 is already
 #libgstreamer-plugins-base1.0-dev:i386	libgstreamer-plugins-base1.0-0:i386 is already
 #no apt-file search libgstinterfaces 0.10 in xenial
 #libsoup2.4-dev:i386      libsoup2.4-1:i386 is already
@@ -75,35 +91,23 @@ share:
 
 #without -pthread, at launchpad runner: _dif/dif~lin.o: undefined reference to symbol 'sem_init@@GLIBC_2.1'
 
-lnk:
-	if [ "${platform}" = "lin" ]; then \
-		export PKG_CONFIG_PATH=/usr/lib/i386-linux-gnu/pkgconfig/:${PKG_CONFIG_PATH}; \
-		$(LD) ${syms} -melf_i386 --dynamic-linker=${dynlink} ${obs} -o ${items_prefix}${projname} -lc -lm `pkg-config --libs gtk+-2.0 gstreamer-pbutils-1.0 gstreamer-app-1.0` -ljpeg -lsoup-2.4 -lasound -lgthread-2.0 -lpthread; \
-	else \
-		i686-w64-mingw32-ld --large-address-aware ${syms} ${obs} -o ${wprojname} -entry _start --start-group \
-		`dpkg -L mingw-w64-i686-dev | grep '\.a' | sed 's/..$$//' | grep -o '[^\/]*$$' | sed 's/^lib/-l/' | xargs echo` \
-		--end-group -L`echo ~`/.wine/drive_c/gstreamer-sdk/0.10/x86/lib/ \
-		-lgtk-win32-2.0 -lgdk-win32-2.0 -lgdk_pixbuf-2.0 -lglib-2.0 -lgobject-2.0 -lgio-2.0 -lgthread-2.0 \
-		-lgstreamer-0.10 -lgstapp-0.10 -lgstinterfaces-0.10 -lgstpbutils-0.10 \
-		-lcairo -lpango-1.0 -lsoup-2.4 -ljpeg; \
-	fi
-fast:
-	$(eval obs = `printf ' ${items_prefix}%s.o' ${items}`)
-link: fast lnk
+#fast:
+#	$(eval obs = `printf ' ${items_prefix}%s.o' ${items}`)
+#linkapp: fast lnkapp
+#link: fast lnk
 #snprintf with circular unresolved requirements
 #cos is in -lmingwex that will work with -lmingw32 -lmsvcrt
 #on win msvcr100 is old and at here is from old java-i586
-lnkapp:
+linkapp:
 	LD_LIBRARY_PATH=/home/bc/v/ovideo-1/AppDir/usr/lib/i386-linux-gnu:/home/bc/v/ovideo-1/AppDir/lib/i386-linux-gnu \
-		$(LD) ${syms} -melf_i386 --dynamic-linker=${dynlink} ${obs} -o ${items_prefix}${projname} \
+		$(LD) ${syms} -melf_i386 --dynamic-linker=${dynlink} ${obs} -o ${lprojname} \
 			-L/home/bc/v/ovideo-1/AppDir/usr/lib/i386-linux-gnu \
 			-l:libc.so.6 -l:libm.so.6 -l:libgtk-x11-2.0.so.0 -l:libgdk-x11-2.0.so.0 -l:libpangocairo-1.0.so.0 -l:libatk-1.0.so.0 -l:libcairo.so.2 -l:libgdk_pixbuf-2.0.so.0 -l:libgio-2.0.so.0 -l:libpangoft2-1.0.so.0 -l:libpango-1.0.so.0 -l:libfontconfig.so.1 -l:libfreetype.so.6 -l:libgstpbutils-1.0.so.0 -l:libgstaudio-1.0.so.0 -l:libgstvideo-1.0.so.0 -l:libgstapp-1.0.so.0 -l:libgstbase-1.0.so.0 -l:libgstreamer-1.0.so.0 -l:libgobject-2.0.so.0 -l:libglib-2.0.so.0 -l:libjpeg.so.8 -l:libsoup-2.4.so.1 -l:libasound.so.2 -l:libpthread.so.0 -l:libgthread-2.0.so.0
-linkapp: fast lnkapp
 
-%: %.s
+%.o: %.s
 	${OCOMP} $< ${OFLAGS}
-	$(eval logs += $@.s.log)
-	$(eval obs += $@.o)
+#	$(eval logs += $@.s.log)
+#	$(eval obs += $@.o)
 
 clean:
 	-printf ' %s.s.log' ${items} | xargs rm -f
@@ -137,6 +141,3 @@ uninstall:
 .PHONY: all install clean distclean uninstall test
 
 .NOTPARALLEL:
-
-#make compile prefix=/usr && make link syms= LD=/home/bc/Desktop/out/LD-.glibc2.27-x86_64.AppImage items_prefix=/home/bc/v/ovideo-1/src/
-#make compile prefix=/usr && make linkapp syms=
--- ovideo-1.orig/src/_dif/dif~win.s
+++ ovideo-1/src/_dif/dif~win.s
@@ -673,6 +673,7 @@ function sound_preview_write_buffer(sd b
     if hwaveout#==0
         return (void)
     endif
+	const wvhd=!
     data lpData#1
     data dwBufferLength#1
     data *dwBytesRecorded#1
@@ -682,7 +683,7 @@ function sound_preview_write_buffer(sd b
     data *lpNext#1
     data *reserved#1
     #lpData, dwBufferLength, and dwFlags members must be set
-    const wvhd^lpData
+#    const wvhd^lpData
     const wvhd_size=!-wvhd
     data wavehd%wvhd
 
@@ -1025,6 +1026,7 @@ function iterate_next_forward_free(sd it
 	call texter("Iterator error")
 endfunction
 
+#SDL_LIL_ENDIAN means byte order is 1234
 const sound_endian_def=1234
 
 function stage_sound_caps()
--- ovideo-1.orig/src/_prepare/frame/screenshot.s
+++ ovideo-1/src/_prepare/frame/screenshot.s
@@ -6,6 +6,8 @@ format elfobj
 
 include "../../_include/include.h"
 
+#29 june 2022: this is ok on windows but on ubuntu... there are 4 gdk functions
+
 function stage_screenshot()
     importx "_gdk_get_default_root_window" gdk_get_default_root_window
     importx "_gdk_drawable_get_size" gdk_drawable_get_size
--- ovideo-1.orig/src/_prepare/output/mkv.s
+++ ovideo-1/src/_prepare/output/mkv.s
@@ -375,6 +375,7 @@ function mkv_info(sd file)
         endif
     endif
 
+const _SegmentUID=!
     chars SegmentUID={0x73,0xA4}
     chars *SegmentUID_size=0x80|16
     data SegmentUID_value#4
@@ -384,6 +385,7 @@ function mkv_info(sd file)
     chars *Duration={0x44,0x89}
     #unsigned integer
     chars *Duration_size=0x84
+const ptr_Duration=!
     data Duration_value#1
     chars *DateUTC={0x44,0x61}
     chars *DateUTC_size=0x80|8
@@ -391,21 +393,18 @@ function mkv_info(sd file)
     data DateUTC_value_low#1
     chars *MuxingApp={0x4D,0x80}
     chars MuxingApp_size#1
-    chars MuxingApp_value={O,A,p,p,l,i,c,a,t,i,o,n,s}
-    chars WritingApp={0x57,0x41}
+const _MuxingApp=!
+    chars *MuxingApp_value={O,A,p,p,l,i,c,a,t,i,o,n,s}
+const App=!-_MuxingApp
+    chars *WritingApp={0x57,0x41}
     chars WritingApp_size#1
     chars WritingApp_value={O,A,p,p,l,i,c,a,t,i,o,n,s}
 
-    const _MuxingApp^MuxingApp_value
-    const MuxingApp_^WritingApp
-    const App=MuxingApp_-_MuxingApp
-    const _SegmentUID^SegmentUID
     const WritingApp_value_^WritingApp_value
     data info_sz=WritingApp_value_-_SegmentUID+App
     data ptr_seg^SegmentUID
 
     #the muxer timecode
-    const ptr_Duration^Duration_value
     const Duration_offset=ptr_Duration-_SegmentUID
     data Dur_offset=Duration_offset
 
@@ -577,7 +576,8 @@ function mkv_track_entry(sd file,sd *siz
     #no lacing used
     chars *Name={0x53,0x6E}
     chars *Name_size=0x85
-    chars Name_value={V,i,d,e,o}
+const track_last_=!
+    chars *Name_value={V,i,d,e,o}
 
     chars *CodecPrivate={0x63,0xA2}
     chars *CodecPrivate_size=0x80+bitmapInfoHeader_size
@@ -594,7 +594,6 @@ function mkv_track_entry(sd file,sd *siz
 ##############
 
     const _track^TrackNumber
-    const track_last_^Name_value
     const track_=track_last_+5
     data track_data^TrackNumber
     data track_sz_init=track_-_track
@@ -656,6 +655,7 @@ function mkv_track_video_entry(sd file,s
     data DisplayHeight_value#1
     chars *FrameRate={0x23,0x83,0xE3}
     chars *FrameRate_size=0x84
+const video_track_last_=!
     data FrameRate_value#1
 
     chars *ColourSpace={0x2E,0xB5,0x24}
@@ -667,7 +667,6 @@ function mkv_track_video_entry(sd file,s
     setcall io mkv_write_read_get()
     if io==(mkv_write)
         const _video_track^PixelWidth
-        const video_track_last_^FrameRate_value
         const video_track_=video_track_last_+4
         data video_track^PixelWidth
         data video_track_sz_init=video_track_-_video_track
@@ -1792,6 +1791,7 @@ endfunction
 #sound entry
 #bool
 function mkv_sound(sd file,sd *size,sd *filepos)
+const _audio=!
     chars CodecID=0x86
  chars *CodecID_size=0x80+1+1+1+1+1+1+    1+1+1+1+    1+1+1
     chars *CodecID_value={A,_,P,C,M,Slash,I,N,T,Slash,L,I,T}
@@ -1815,7 +1815,8 @@ function mkv_sound(sd file,sd *size,sd *
 
     chars *Audio={0xE1}
     chars Audio_size=0x80
-    chars SamplingFrequency=0xB5
+const _audiospec=!
+    chars *SamplingFrequency=0xB5
     chars *SamplingFrequency_size=0x84
     data SamplingFrequency_value#1
     chars *Channels=0x9F
@@ -1823,13 +1824,12 @@ function mkv_sound(sd file,sd *size,sd *
     data Channels_value#1
     chars *BitDepth={0x62,0x64}
     chars *BitDepth_size=0x84
+const audiospec_=!
     data BitDepth_value#1
 
     sd io
     setcall io mkv_write_read_get()
     if io==(mkv_write)
-        const _audiospec^SamplingFrequency
-        const audiospec_^BitDepth_value
         const audiospec_@=audiospec_+4
         const audiospec_size=audiospec_@-_audiospec
         or Audio_size (audiospec_size)
@@ -1848,7 +1848,6 @@ function mkv_sound(sd file,sd *size,sd *
         setcall BitDepth_value dword_reverse(BitDepth_value)
     endif
 
-    const _audio^CodecID
     const audio_size=audiospec_@-_audio
     data audio^CodecID
 
--- ovideo-1.orig/src/_search/dialog_fns.s
+++ ovideo-1/src/_search/dialog_fns.s
@@ -17,47 +17,45 @@ function search_preferences_set_init()
 
     #FIELDS
     #group1
-    DATA startlabel#1
+const search_structures=!
+    DATA *startlabel#1
     #
-    const search_structures^startlabel
+const search_start_entry=!
+    DATA *startentry#1
     #
-    DATA startentry#1
-    #
-    const search_start_entry^startentry
     const search_start=search_start_entry-search_structures
     #
     DATA *get_uri#1
-    DATA endentry#1
+const search_end_entry=!
+    DATA *endentry#1
     #
-    const search_end_entry^endentry
     const search_end=search_end_entry-search_structures
     #
     DATA *endlabel#1
     #group2
-    DATA search_wrap_begin#1
+const search_group2=!
+    DATA *search_wrap_begin#1
     const search_start_wrap=0
-    const search_group2^search_wrap_begin
     const search_fields_struct_size=search_group2-search_structures
     DATA *#3
-    DATA search_wrap_end#1
-    const search_end_wrap_entry^search_wrap_end
+const search_end_wrap_entry=!
+    DATA *search_wrap_end#1
     const search_end_wrap=search_end_wrap_entry-search_group2
     #
 
     #VARS
     #group1
-    DATA search_preferences_uri_start#1
-    #
-    const search_first_var_offset^search_preferences_uri_start
+const search_first_var_offset=!
+    DATA *search_preferences_uri_start#1
     #
     DATA *search_preferences_uri_end#1
     #group2
-    DATA search_preferences_wrap_start#1
-    const search_group2_vars^search_preferences_wrap_start
+const search_group2_vars=!
+    DATA *search_preferences_wrap_start#1
     const search_vars_struct_size=search_group2_vars-search_first_var_offset
     #
-    DATA search_preferences_wrap_end#1
-    const search_last_var_offset^search_preferences_wrap_end
+const search_last_var_offset=!
+    DATA *search_preferences_wrap_end#1
     const search_after_last_var_offset=search_last_var_offset+DWORD
     const search_vars_size=search_after_last_var_offset-search_first_var_offset
     #
--- /dev/null
+++ ovideo-1/src/md
@@ -0,0 +1,19 @@
+
+#./md
+
+#sudo ./md install
+#don't run with o from root
+
+#sudo ./md uninstall
+
+#./md clean
+
+if [ -z "${1}" ]; then
+a=all
+else
+a=${1}
+fi
+
+#make compile prefix=/usr && make linkapp syms=
+
+make ${a} prefix=/usr OFLAGSEXTRA="function_name 1" syms= LD=/home/bc/Desktop/out/LD-.glibc2.27-x86_64.AppImage items_prefix=`pwd`/
--- ovideo-1.orig/src/media/mp4.s
+++ ovideo-1/src/media/mp4.s
@@ -46,12 +46,42 @@ import "av_dialog_run" av_dialog_run
 import "av_dialog_close" av_dialog_close
 import "av_dialog_stop" av_dialog_stop
 
+
+
+#importx "_fread" fread
+#importx "_fwrite" fwrite
+#function extragere(ss location)
+#	data extragere_off1#1
+#	const extr_1^extragere_off1
+#	data extragere_off2#1
+#	const extr_2^extragere_off2
+#	sd file
+#	call openfile(#file,location,"rb")
+#	sd mp3_file
+#	chars out#256
+#	call sprintf(#out,"%s.mp3",location)
+#	call openfile(#mp3_file,#out,"wb")
+#	sd mp3_sz;set mp3_sz extragere_off2;sub mp3_sz extragere_off1
+#	call file_seek_set(file,extragere_off1)
+#	sd mp3Mem;setcall mp3Mem memalloc(mp3_sz)
+#	Call fread(mp3Mem,1,mp3_sz,file)
+#	Call fwrite(mp3Mem,1,mp3_sz,mp3_file)
+#	call fclose(mp3_file)
+#	call fclose(file)
+#endfunction
+
+
+
+
 function mp4_write()
     call mp4_write_expand_set((mp4_write))
     ss location
     import "stage_get_output_container" stage_get_output_container
     setcall location stage_get_output_container()
     call av_dialog_run(mp4_dialog,location)
+
+#call extragere(location)
+
 endfunction
 #
 function mp4_filewrite(sd file)
@@ -1234,6 +1264,10 @@ import "file_seekSet_setDwRev_goEnd" fil
 
 #bool
 function mp4_mdat(sd file)
+
+#data off1%extr_1
+#call file_tell(file,off1)
+
     sd bool
     setcall bool mp4_mdat_sound(file)
     if bool!=1
@@ -1255,6 +1289,9 @@ function mp4_mdat(sd file)
         return (FALSE)
     endif
 
+#data off2%extr_2
+#set off2# file_pos
+
     #
     sd all_size_of_sample
     sd p_all_size_of_sample^all_size_of_sample
--- ovideo-1.orig/src/media/mpeg-mp3_input.s
+++ ovideo-1/src/media/mpeg-mp3_input.s
@@ -172,7 +172,6 @@ function l3_subband_init()
     import "fsub_quad" fsub_quad
     import "fadd_quad" fadd_quad
     import "double_to_int" double_to_int
-    importx "_cos" cos
     importx "_modf" modf
     sd value
     sd value_2
@@ -195,8 +194,15 @@ function l3_subband_init()
             mult value value_2
             call fild_value(value)
             call fmul_quad(PI64)
-            call fstp_quad(double)
-            call cos(double_low,double_high)
+
+		#this is problematic on linux
+		#call fstp_quad(double)
+		#importx "_cos" cos
+		#call cos(double_low,double_high)
+		#small diffs only
+		import "fcos" fcos
+		call fcos()
+
             call fmul_quad(const1)
             sd bool
             setcall bool fcom_quad_greater_or_equal(const4)
--- ovideo-1.orig/src/media/mpeg-mp3_mdct.s
+++ ovideo-1/src/media/mpeg-mp3_mdct.s
@@ -215,8 +215,6 @@ import "fdiv_quad" fdiv_quad
 import "fild_value" fild_value
 import "double_to_int" double_to_int
 importx "_sqrt" sqrt
-importx "_sin" sin
-importx "_cos" cos
 import "slen" slen
 
 function l3_mdct_init()
@@ -315,8 +313,15 @@ function l3_mdct_init()
             call fild_value(k)
             call fadd_quad(const1)
             call fmul_quad(const2)
-            call fstp_quad(double)
-            call sin(double_low,double_high)
+
+		#cos was problematic on linux
+		#call fstp_quad(double)
+		#importx "_sin" sin
+		#call sin(double_low,double_high)
+		#small diffs only
+		import "fsin" fsin
+		call fsin()
+
             #
             set value m
             mult value 2
@@ -332,8 +337,14 @@ function l3_mdct_init()
             call fstp_quad(double)
             call fild_value(value)
             call fmul_quad(double)
-            call fstp_quad(double)
-            call cos(double_low,double_high)
+
+		#this is problematic on linux
+		#call fstp_quad(double)
+		#importx "_cos" cos
+		#call cos(double_low,double_high)
+		import "fcos" fcos
+		call fcos()
+
             call fstp_quad(double)
             call fmul_quad(double)
             #
--- ovideo-1.orig/src/util/floating.s
+++ ovideo-1/src/util/floating.s
@@ -281,3 +281,11 @@ function fcom_quad_greater_or_equal(sd p
         return 0
     endelse
 endfunction
+
+function fcos()
+	hex 0xD9,0xFF
+endfunction
+
+function fsin()
+	hex 0xD9,0xFE
+endfunction
--- ovideo-1.orig/src/wmake
+++ ovideo-1/src/wmake
@@ -1,2 +1,8 @@
 
-make platform=win $@
+#optional 1 debug/clean
+
+if [ -z "${1}" ] || [ "$1" = "clean" ]; then
+	make platform=win $@
+else
+	make platform=win syms= OFLAGSEXTRA="function_name 1" $@
+fi
--- ovideo-1.orig/version.txt
+++ ovideo-1/version.txt
@@ -1 +1 @@
-1.185
\ No newline at end of file
+1.186
\ No newline at end of file
--- ovideo-1.orig/wmake
+++ ovideo-1/wmake
@@ -1,4 +1,13 @@
 
+#./wmake
+
+#./wmake ../b
+
+#./wmake 1 clean
+
+#./wmake ../b all
+#this is debug but tricking soundrecorder
+
 if [ -z "$1" ] || [ -n "$2" ]
 then
 cd src
@@ -20,17 +29,17 @@ f=$1
 fi
 
 mkdir $f
-cp src/ovideo.exe $f
+rsync -a src/ovideo.exe $f
 
-cp -r build/img $f
+rsync -a -r build/img $f
 
 mkdir $f/html
-cp html/html/use.html $f/html
+rsync -a html/html/use.html $f/html
 
-cp version.txt $f
+rsync -a version.txt $f
 
 mkdir $f/sys
-cp build/sys/* $f/sys
+rsync -a build/sys/* $f/sys
 
 mkdir $f/captures
 
@@ -52,8 +61,8 @@ fi
 
 if [ "$2" != "clean" ]; then
 
-cp soundrecorder/src/soundrecorder.exe $f
-cp soundrecorder/options.txt $f
+rsync -a soundrecorder/src/soundrecorder.exe $f
+rsync -a soundrecorder/options.txt $f
 
 if [ -z "$1" ]
 then
