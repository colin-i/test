
#1 requirements/service

if [ -z "${1}" ]; then
	sudo apt install python3-rpi.gpio && \
	sudo pip3 install fanshim  --break-system-packages
else
	#off low high on brigt
	#rpi3? 40 44 46 50 0-255
	#rpi4? 50 54 56 60 0-255

	off=${1}
	low=${2}
	high=${3}
	on=${4}
	brightness=$5

	#automatic.py is at https://github.com/pimoroni/fanshim-python /examples (make install is not working from the first try now)
	#long press the button(blue blinking) to switch from manual(same button short press) or auto (high red, green low)
	cd ~/fanshim-python/examples

	#sudo, else root warning
	sudo ./install-service.sh --brightness ${brightness} --delay 5 --on-threshold ${on} --off-threshold ${off} --low-temp ${low} --high-temp ${high}

	service pimoroni-fanshim status

	cat /etc/systemd/system/pimoroni-fanshim.service

	cat /sys/class/thermal/thermal_zone*/temp
fi

# vcgencmd measure_temp
